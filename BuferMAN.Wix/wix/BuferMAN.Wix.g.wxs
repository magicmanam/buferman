<?xml version="1.0" encoding="utf-8"?>
<!--
<auto-generated>
    This code was generated by WixSharp.
    Changes to this file will be lost if the code is regenerated.
</auto-generated>
-->
<Wix xmlns="http://schemas.microsoft.com/wix/2006/wi">
  <Product Id="564cedef-dfeb-4ad1-bfb4-2cd848ac38ba" Name="BuferMAN" Language="1033" Codepage="Windows-1252" Version="1.2.1.0" UpgradeCode="564cedef-dfeb-4ad1-bfb4-2cd8388c28b9" Manufacturer="Magicmanam">
    <Package InstallerVersion="200" Compressed="yes" SummaryCodepage="Windows-1252" Languages="1033" />
    <Media Id="1" Cabinet="BuferMAN_.cab" EmbedCab="yes" />

    <Directory Id="TARGETDIR" Name="SourceDir">
      <Directory Id="ProgramFilesFolder" Name="ProgramFilesFolder">
        <Directory Id="ProgramFilesFolder.magicmanam" Name="magicmanam">
          <Directory Id="INSTALLDIR" Name="BuferMAN">

            <Component Id="Component.BuferMAN.Application.dll_840666049" Guid="564cedef-dfeb-4ad1-bfb4-2cd8ec68a4dd">
              <File Id="BuferMAN.Application.dll_840666049" Source="..\BuferMAN\bin\Release\BuferMAN.Application.dll" />
            </Component>

            <Component Id="Component.BuferMAN.Assets.dll_1687450904" Guid="564cedef-dfeb-4ad1-bfb4-2cd8f3fa65c0">
              <File Id="BuferMAN.Assets.dll_1687450904" Source="..\BuferMAN\bin\Release\BuferMAN.Assets.dll" />
            </Component>

            <Component Id="Component.BuferMAN.Clipboard.dll_3142146511" Guid="564cedef-dfeb-4ad1-bfb4-2cd8838d60d6">
              <File Id="BuferMAN.Clipboard.dll_3142146511" Source="..\BuferMAN\bin\Release\BuferMAN.Clipboard.dll" />
            </Component>

            <Component Id="Component.BuferMAN.ClipPresentations.dll_254717464" Guid="564cedef-dfeb-4ad1-bfb4-2cd835cfb964">
              <File Id="BuferMAN.ClipPresentations.dll_254717464" Source="..\BuferMAN\bin\Release\BuferMAN.ClipPresentations.dll" />
            </Component>

            <Component Id="Component.BuferMAN.ContextMenu.dll_3967256767" Guid="564cedef-dfeb-4ad1-bfb4-2cd863800ae9">
              <File Id="BuferMAN.ContextMenu.dll_3967256767" Source="..\BuferMAN\bin\Release\BuferMAN.ContextMenu.dll" />
            </Component>

            <Component Id="Component.BuferMAN.DI.dll_3971257198" Guid="564cedef-dfeb-4ad1-bfb4-2cd82fe7d34f">
              <File Id="BuferMAN.DI.dll_3971257198" Source="..\BuferMAN\bin\Release\BuferMAN.DI.dll" />
            </Component>

            <Component Id="Component.BuferMAN.Files.dll_178859045" Guid="564cedef-dfeb-4ad1-bfb4-2cd8783c13f9">
              <File Id="BuferMAN.Files.dll_178859045" Source="..\BuferMAN\bin\Release\BuferMAN.Files.dll" />
            </Component>

            <Component Id="Component.BuferMAN.Infrastructure.dll_1799397964" Guid="564cedef-dfeb-4ad1-bfb4-2cd83cfbba9b">
              <File Id="BuferMAN.Infrastructure.dll_1799397964" Source="..\BuferMAN\bin\Release\BuferMAN.Infrastructure.dll" />
            </Component>

            <Component Id="Component.BuferMAN.Menu.dll_3220873386" Guid="564cedef-dfeb-4ad1-bfb4-2cd810034cd8">
              <File Id="BuferMAN.Menu.dll_3220873386" Source="..\BuferMAN\bin\Release\BuferMAN.Menu.dll" />
            </Component>

            <Component Id="Component.BuferMAN.Models.dll_4164040731" Guid="564cedef-dfeb-4ad1-bfb4-2cd8b7af1b37">
              <File Id="BuferMAN.Models.dll_4164040731" Source="..\BuferMAN\bin\Release\BuferMAN.Models.dll" />
            </Component>

            <Component Id="Component.BuferMAN.Plugins.dll_2105885682" Guid="564cedef-dfeb-4ad1-bfb4-2cd881cf7853">
              <File Id="BuferMAN.Plugins.dll_2105885682" Source="..\BuferMAN\bin\Release\BuferMAN.Plugins.dll" />
            </Component>

            <Component Id="Component.BuferMAN.Settings.dll_2517043052" Guid="564cedef-dfeb-4ad1-bfb4-2cd8248c01a3">
              <File Id="BuferMAN.Settings.dll_2517043052" Source="..\BuferMAN\bin\Release\BuferMAN.Settings.dll" />
            </Component>

            <Component Id="Component.BuferMAN.Storage.dll_4026366092" Guid="564cedef-dfeb-4ad1-bfb4-2cd8fa5c7550">
              <File Id="BuferMAN.Storage.dll_4026366092" Source="..\BuferMAN\bin\Release\BuferMAN.Storage.dll" />
            </Component>

            <Component Id="Component.BuferMAN.View.dll_957680573" Guid="564cedef-dfeb-4ad1-bfb4-2cd8f4e4f242">
              <File Id="BuferMAN.View.dll_957680573" Source="..\BuferMAN\bin\Release\BuferMAN.View.dll" />
            </Component>

            <Component Id="Component.BuferMAN.Windows.dll_427861149" Guid="564cedef-dfeb-4ad1-bfb4-2cd8fae00a81">
              <File Id="BuferMAN.Windows.dll_427861149" Source="..\BuferMAN\bin\Release\BuferMAN.Windows.dll" />
            </Component>

            <Component Id="Component.BuferMAN.WinForms.dll_2923466464" Guid="564cedef-dfeb-4ad1-bfb4-2cd86b34e4bb">
              <File Id="BuferMAN.WinForms.dll_2923466464" Source="..\BuferMAN\bin\Release\BuferMAN.WinForms.dll" />
            </Component>

            <Component Id="Component.log4net.dll_1784658883" Guid="564cedef-dfeb-4ad1-bfb4-2cd82b331d3e">
              <File Id="log4net.dll_1784658883" Source="..\BuferMAN\bin\Release\log4net.dll" />
            </Component>

            <Component Id="Component.Logging.dll_1279715514" Guid="564cedef-dfeb-4ad1-bfb4-2cd8f057034b">
              <File Id="Logging.dll_1279715514" Source="..\BuferMAN\bin\Release\Logging.dll" />
            </Component>

            <Component Id="Component.magicmanam.UndoRedo.dll_4214153592" Guid="564cedef-dfeb-4ad1-bfb4-2cd8ace8c7f2">
              <File Id="magicmanam.UndoRedo.dll_4214153592" Source="..\BuferMAN\bin\Release\magicmanam.UndoRedo.dll" />
            </Component>

            <Component Id="Component.magicmanam.Windows.ClipboardViewer.dll_3342965503" Guid="564cedef-dfeb-4ad1-bfb4-2cd8f5abb42e">
              <File Id="magicmanam.Windows.ClipboardViewer.dll_3342965503" Source="..\BuferMAN\bin\Release\magicmanam.Windows.ClipboardViewer.dll" />
            </Component>

            <Component Id="Component.magicmanam.Windows.dll_2997702077" Guid="564cedef-dfeb-4ad1-bfb4-2cd83f64cd91">
              <File Id="magicmanam.Windows.dll_2997702077" Source="..\BuferMAN\bin\Release\magicmanam.Windows.dll" />
            </Component>

            <Component Id="Component.Newtonsoft.Json.dll_3232142950" Guid="564cedef-dfeb-4ad1-bfb4-2cd8c2aa28e7">
              <File Id="Newtonsoft.Json.dll_3232142950" Source="..\BuferMAN\bin\Release\Newtonsoft.Json.dll" />
            </Component>

            <Component Id="Component.SimpleInjector.dll_3985047579" Guid="564cedef-dfeb-4ad1-bfb4-2cd86aab078e">
              <File Id="SimpleInjector.dll_3985047579" Source="..\BuferMAN\bin\Release\SimpleInjector.dll" />
            </Component>

            <Component Id="Component.BuferMAN.exe.config_623035188" Guid="564cedef-dfeb-4ad1-bfb4-2cd89b319f57">
              <File Id="BuferMAN.exe.config_623035188" Source="..\BuferMAN\bin\Release\BuferMAN.exe.config" />
            </Component>

            <Component Id="Component.BuferMAN.Settings.dll.config_3598274013" Guid="564cedef-dfeb-4ad1-bfb4-2cd850807656">
              <File Id="BuferMAN.Settings.dll.config_3598274013" Source="..\BuferMAN\bin\Release\BuferMAN.Settings.dll.config" />
            </Component>

            <Component Id="Component.buferman.ico_2539484650" Guid="564cedef-dfeb-4ad1-bfb4-2cd8a016925e">
              <File Id="buferman.ico_2539484650" Source="..\BuferMAN\bin\Release\buferman.ico" />
            </Component>

            <Component Id="Component.folder.ico_2265879469" Guid="564cedef-dfeb-4ad1-bfb4-2cd8dce6f2ee">
              <File Id="folder.ico_2265879469" Source="..\BuferMAN\bin\Release\folder.ico" />
            </Component>

            <Component Id="Component.skype.ico_1489561710" Guid="564cedef-dfeb-4ad1-bfb4-2cd87bae2e6e">
              <File Id="skype.ico_1489561710" Source="..\BuferMAN\bin\Release\skype.ico" />
            </Component>

            <Component Id="Component.log4net.xml_1784593375" Guid="564cedef-dfeb-4ad1-bfb4-2cd846be9ea5">
              <File Id="log4net.xml_1784593375" Source="..\BuferMAN\bin\Release\log4net.xml" />
            </Component>

            <Component Id="Component.Newtonsoft.Json.xml_3232077410" Guid="564cedef-dfeb-4ad1-bfb4-2cd8a62fb4ca">
              <File Id="Newtonsoft.Json.xml_3232077410" Source="..\BuferMAN\bin\Release\Newtonsoft.Json.xml" />
            </Component>

            <Component Id="Component.SimpleInjector.xml_3220373530" Guid="564cedef-dfeb-4ad1-bfb4-2cd8eadd6480">
              <File Id="SimpleInjector.xml_3220373530" Source="..\BuferMAN\bin\Release\SimpleInjector.xml" />
            </Component>

            <Component Id="Component.BuferMAN.exe_2088022631" Guid="564cedef-dfeb-4ad1-bfb4-2cd8c34286a3">
              <File Id="BuferMAN.exe_2088022631" Source="..\BuferMAN\bin\Release\BuferMAN.exe" />
            </Component>

            <Component Id="Component.Documentation.html_2217347364" Guid="564cedef-dfeb-4ad1-bfb4-2cd8f7381e21">
              <File Id="Documentation.html_2217347364" Source="..\BuferMAN\bin\Release\Documentation.html" />
            </Component>

            <Directory Id="INSTALLDIR.ru" Name="ru">

              <Component Id="Component.BuferMAN.Application.resources.dll_428213912" Guid="564cedef-dfeb-4ad1-bfb4-2cd8aba05665">
                <File Id="BuferMAN.Application.resources.dll_428213912" Source="..\BuferMAN\bin\Release\ru\BuferMAN.Application.resources.dll" />
              </Component>

              <Component Id="Component.BuferMAN.Clipboard.resources.dll_3124443618" Guid="564cedef-dfeb-4ad1-bfb4-2cd87843936b">
                <File Id="BuferMAN.Clipboard.resources.dll_3124443618" Source="..\BuferMAN\bin\Release\ru\BuferMAN.Clipboard.resources.dll" />
              </Component>

              <Component Id="Component.BuferMAN.ContextMenu.resources.dll_2185372560" Guid="564cedef-dfeb-4ad1-bfb4-2cd88d3bfc05">
                <File Id="BuferMAN.ContextMenu.resources.dll_2185372560" Source="..\BuferMAN\bin\Release\ru\BuferMAN.ContextMenu.resources.dll" />
              </Component>

              <Component Id="Component.BuferMAN.Files.resources.dll_3081302970" Guid="564cedef-dfeb-4ad1-bfb4-2cd8e6ec0a57">
                <File Id="BuferMAN.Files.resources.dll_3081302970" Source="..\BuferMAN\bin\Release\ru\BuferMAN.Files.resources.dll" />
              </Component>

              <Component Id="Component.BuferMAN.Menu.resources.dll_2439386960" Guid="564cedef-dfeb-4ad1-bfb4-2cd8080ed287">
                <File Id="BuferMAN.Menu.resources.dll_2439386960" Source="..\BuferMAN\bin\Release\ru\BuferMAN.Menu.resources.dll" />
              </Component>

              <Component Id="Component.BuferMAN.Plugins.resources.dll_2446414763" Guid="564cedef-dfeb-4ad1-bfb4-2cd8e1f22b82">
                <File Id="BuferMAN.Plugins.resources.dll_2446414763" Source="..\BuferMAN\bin\Release\ru\BuferMAN.Plugins.resources.dll" />
              </Component>

              <Component Id="Component.BuferMAN.Storage.resources.dll_2617845720" Guid="564cedef-dfeb-4ad1-bfb4-2cd8582a9fbd">
                <File Id="BuferMAN.Storage.resources.dll_2617845720" Source="..\BuferMAN\bin\Release\ru\BuferMAN.Storage.resources.dll" />
              </Component>

              <Component Id="Component.BuferMAN.Windows.resources.dll_585159397" Guid="564cedef-dfeb-4ad1-bfb4-2cd8d30f3b6c">
                <File Id="BuferMAN.Windows.resources.dll_585159397" Source="..\BuferMAN\bin\Release\ru\BuferMAN.Windows.resources.dll" />
              </Component>

              <Component Id="Component.BuferMAN.WinForms.resources.dll_807183160" Guid="564cedef-dfeb-4ad1-bfb4-2cd81745b6cc">
                <File Id="BuferMAN.WinForms.resources.dll_807183160" Source="..\BuferMAN\bin\Release\ru\BuferMAN.WinForms.resources.dll" />
              </Component>

            </Directory>
          </Directory>
        </Directory>
      </Directory>

      <Directory Id="DesktopFolder" Name="DesktopFolder">

        <Component Id="Component.BuferMAN___" Guid="564cedef-dfeb-4ad1-bfb4-2cd8f61eb9c2">
          <Shortcut Id="DesktopFolder.BuferMAN___" WorkingDirectory="INSTALLDIR" Target="[INSTALLDIR]\BuferMAN.exe" Name="BuferMAN.lnk" Icon="IconFile1_buferman.ico" IconIndex="0" />

          <CreateFolder />

          <RegistryKey Root="HKCU" Key="Software\WixSharp\Used">
            <RegistryValue Value="0" Type="string" KeyPath="yes" />
          </RegistryKey>
        </Component>

      </Directory>

      <Component Id="TARGETDIR" Guid="564cedef-dfeb-4ad1-bfb4-2cd8ab5c982c" KeyPath="yes">
        <RemoveFolder Id="TARGETDIR" On="uninstall" />
      </Component>

    </Directory>

    <UI />

    <Icon Id="app_icon.ico" SourceFile="..\BuferMAN\bin\Release\buferman.ico" />

    <Upgrade Id="564cedef-dfeb-4ad1-bfb4-2cd8388c28b9">
      <UpgradeVersion Minimum="0.0.0.0" Maximum="1.2.1.0" IncludeMinimum="yes" IncludeMaximum="no" Property="UPGRADEFOUND" />
      <UpgradeVersion Minimum="1.2.1.0" IncludeMinimum="no" Property="NEWPRODUCTFOUND" />
    </Upgrade>

    <Icon Id="IconFile1_buferman.ico" SourceFile="..\BuferMAN\bin\Release\buferman.ico" />

    <CustomAction Id="WixSharp_InitRuntime_Action" BinaryKey="WixSharp_InitRuntime_Action_File" DllEntry="WixSharp_InitRuntime_Action" Return="check" Execute="immediate" />
    <CustomAction Id="Set_WixSharp_AfterInstall_Action_Props" Property="WixSharp_AfterInstall_Action" Value="WixSharp_AfterInstall_Handlers=[WixSharp_AfterInstall_Handlers];WIXSHARP_RUNTIME_DATA=[WIXSHARP_RUNTIME_DATA];INSTALLDIR=[INSTALLDIR];UILevel=[UILevel];ProductName=[ProductName];FOUNDPREVIOUSVERSION=[FOUNDPREVIOUSVERSION];INSTALLDIR=[INSTALLDIR];UILevel=[UILevel];ProductCode=[ProductCode];ADDLOCAL=[ADDLOCAL];ADDFEATURES=[ADDFEATURES]" />
    <CustomAction Id="WixSharp_AfterInstall_Action" BinaryKey="WixSharp_InitRuntime_Action_File" DllEntry="WixSharp_AfterInstall_Action" Return="check" Impersonate="no" Execute="deferred" />
    <CustomAction Id="PreventDowngrading" Error="Newer version already installed" />

    <Binary Id="WixSharp_InitRuntime_Action_File" SourceFile="WixSharp.CA.dll" />

    <Property Id="WixSharp_AfterInstall_Handlers" Value="BuferMAN.Wix, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null|BuferMAN.Wix.Program+&lt;&gt;c|&lt;Main&gt;b__0_0" />
    <Property Id="ARPCONTACT" Value="Andrei Muski" />
    <Property Id="ARPPRODUCTICON" Value="app_icon.ico" />

    <Feature Id="Complete" Title="Complete" Absent="allow" Level="1">
      <ComponentRef Id="Component.BuferMAN.Application.dll_840666049" />
      <ComponentRef Id="Component.BuferMAN.Assets.dll_1687450904" />
      <ComponentRef Id="Component.BuferMAN.Clipboard.dll_3142146511" />
      <ComponentRef Id="Component.BuferMAN.ClipPresentations.dll_254717464" />
      <ComponentRef Id="Component.BuferMAN.ContextMenu.dll_3967256767" />
      <ComponentRef Id="Component.BuferMAN.DI.dll_3971257198" />
      <ComponentRef Id="Component.BuferMAN.Files.dll_178859045" />
      <ComponentRef Id="Component.BuferMAN.Infrastructure.dll_1799397964" />
      <ComponentRef Id="Component.BuferMAN.Menu.dll_3220873386" />
      <ComponentRef Id="Component.BuferMAN.Models.dll_4164040731" />
      <ComponentRef Id="Component.BuferMAN.Plugins.dll_2105885682" />
      <ComponentRef Id="Component.BuferMAN.Settings.dll_2517043052" />
      <ComponentRef Id="Component.BuferMAN.Storage.dll_4026366092" />
      <ComponentRef Id="Component.BuferMAN.View.dll_957680573" />
      <ComponentRef Id="Component.BuferMAN.Windows.dll_427861149" />
      <ComponentRef Id="Component.BuferMAN.WinForms.dll_2923466464" />
      <ComponentRef Id="Component.log4net.dll_1784658883" />
      <ComponentRef Id="Component.Logging.dll_1279715514" />
      <ComponentRef Id="Component.magicmanam.UndoRedo.dll_4214153592" />
      <ComponentRef Id="Component.magicmanam.Windows.ClipboardViewer.dll_3342965503" />
      <ComponentRef Id="Component.magicmanam.Windows.dll_2997702077" />
      <ComponentRef Id="Component.Newtonsoft.Json.dll_3232142950" />
      <ComponentRef Id="Component.SimpleInjector.dll_3985047579" />
      <ComponentRef Id="Component.BuferMAN.exe.config_623035188" />
      <ComponentRef Id="Component.BuferMAN.Settings.dll.config_3598274013" />
      <ComponentRef Id="Component.buferman.ico_2539484650" />
      <ComponentRef Id="Component.folder.ico_2265879469" />
      <ComponentRef Id="Component.skype.ico_1489561710" />
      <ComponentRef Id="Component.log4net.xml_1784593375" />
      <ComponentRef Id="Component.Newtonsoft.Json.xml_3232077410" />
      <ComponentRef Id="Component.SimpleInjector.xml_3220373530" />
      <ComponentRef Id="Component.BuferMAN.exe_2088022631" />
      <ComponentRef Id="Component.Documentation.html_2217347364" />
      <ComponentRef Id="Component.BuferMAN.Application.resources.dll_428213912" />
      <ComponentRef Id="Component.BuferMAN.Clipboard.resources.dll_3124443618" />
      <ComponentRef Id="Component.BuferMAN.ContextMenu.resources.dll_2185372560" />
      <ComponentRef Id="Component.BuferMAN.Files.resources.dll_3081302970" />
      <ComponentRef Id="Component.BuferMAN.Menu.resources.dll_2439386960" />
      <ComponentRef Id="Component.BuferMAN.Plugins.resources.dll_2446414763" />
      <ComponentRef Id="Component.BuferMAN.Storage.resources.dll_2617845720" />
      <ComponentRef Id="Component.BuferMAN.Windows.resources.dll_585159397" />
      <ComponentRef Id="Component.BuferMAN.WinForms.resources.dll_807183160" />
      <ComponentRef Id="Component.BuferMAN___" />
      <ComponentRef Id="TARGETDIR" />
    </Feature>

    <InstallExecuteSequence>
      <Custom Action="WixSharp_InitRuntime_Action" Before="AppSearch"> (1) </Custom>
      <Custom Action="Set_WixSharp_AfterInstall_Action_Props" After="InstallFiles" />
      <Custom Action="WixSharp_AfterInstall_Action" After="Set_WixSharp_AfterInstall_Action_Props">1</Custom>
      <Custom Action="PreventDowngrading" After="FindRelatedProducts">NEWPRODUCTFOUND</Custom>

      <RemoveExistingProducts After="InstallInitialize" />
    </InstallExecuteSequence>

    <InstallUISequence>
      <Custom Action="PreventDowngrading" After="FindRelatedProducts">NEWPRODUCTFOUND</Custom>
    </InstallUISequence>

  </Product>
</Wix>

